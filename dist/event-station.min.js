/*
 * event-station v2.0.0-beta.2
 * Copyright (c) 2016-2025 Morris Allison III <author@morris.xyz> (http://morris.xyz). All rights reserved.
 * Released under the MIT license
 * @preserve
 */
function f(z,B){let J=B.eventName,G=z.listenersMap;if(!G[J])G[J]=[];let K=B.stationMetas;if(!K)B.stationMetas=[z];else K.push(z);G[J].push(B),z.listenerCount++;let Q=B.hearer;if(Q)Q.stationMeta.hearingCount++}function F(z,B,J){if(J===!0)return z===B;let G=z.matchCallback;if(G&&G!==B.matchCallback)return!1;let K=z.matchContext;if(K!==void 0&&K!==B.matchContext)return!1;let Q=z.hearer;if(Q&&Q!==B.hearer)return!1;let U=z.eventName;if(U!==void 0&&U!==B.eventName)return!1;return!0}function R(z,B,J){if(z.listenerCount<1)return;let G=z.listenersMap,K=B.eventName,Q=G[K];if(!Q)return;let U=Q.length;if(U===1){if(!F(B,Q[0],J))return;delete G[K],z.listenerCount--,E(B),C(z,B);return}for(let W=0,X=U;W<X;W++){let Y=Q[W];if(!F(B,Y,J))continue;Q.splice(W,1),z.listenerCount--,W--,X--,E(B),C(z,B)}if(Q.length<1)delete G[K]}function C(z,B){let J=B.stationMetas;if(!J)return;if(J.length===1){B.stationMetas=void 0;return}let G=[];for(let K of J)if(K!==z)G.push(K);if(G.length<1)B.stationMetas=void 0;else B.stationMetas=G}function E(z){let B=z.hearer;if(B)B.stationMeta.hearingCount--}function k(z){let B=z.stationMetas;if(!B)return;for(let J of B)R(J,z,!0)}function A(z,B,J,G){let K=G.length,Q=B.stationMeta;Q.isPropagationStopped=!1;let U=[],W=z.slice();for(let X of W){let Y;if(Q.isPropagationStopped)return Q.isPropagationStopped=!1,U;if(X.isPaused)continue;let{callback:Z,context:D}=X;if(Z){switch(K){case 0:Y=Z.call(D);break;case 1:Y=Z.call(D,G[0]);break;case 2:Y=Z.call(D,G[0],G[1]);break;case 3:Y=Z.call(D,G[0],G[1],G[2]);break;default:Y=Z.apply(D,G);break}U.push(Y)}let P=X.resolves;if(P){for(let x of P)x(X);X.resolves=void 0}let{maxOccurrences:y}=X,{occurrences:H}=X;if(y!==void 0){if(H===void 0)H=0;if(X.occurrences=++H,H===y)k(X)}}return U}function N(z){if(z.listenerCount<1)return[];let B=z.listenersMap,J=[];for(let G in B)J=J.concat(B[G]);return J}function S(z,B,J){if(B.length<1)return!1;for(let K of B)if(F(z,K,J))return!0;return!1}function T(z,B,J){let G=z.listenersMap,K=B.eventName,Q;if(K===void 0)Q=N(z);else if(Q=G[K],!Q)return!1;return S(B,Q,J)}class V{get count(){return this.listeners.length}originStation;listeners;constructor(z,B){this.originStation=z,this.listeners=B}occur(z){if(z<1)throw new Error("The maximum occurrences must be greater than or equal to one.");let B=this.listeners;for(let J of B)J.maxOccurrences=z;return this}calling(z){let B=this.listeners;for(let J of B)J.callback=z,J.matchCallback=z;return this}once(z){return this.calling(z).occur(1)}off(){let z=this.listeners;for(let B of z)k(B);return this}using(z){let B=this.listeners;for(let J of B)J.context=z,J.matchContext=z;return this}addTo(z){let B=this.listeners,J=z.stationMeta;for(let G of B){let K=G.crossOrigin;if(K&&K!==z)throw new Error("Cross-emitter listeners can only be attached to their origin station.");f(J,G)}return this}removeFrom(z){let B=this.listeners,J=z.stationMeta;for(let G of B)R(J,G,!0);return this}moveTo(z){return this.removeFrom(this.originStation),this.originStation=z,this.addTo(z),this}has(z,B){return S(z,this.listeners,B)}attach(){return this.addTo(this.originStation)}detach(){return this.removeFrom(this.originStation)}isAttachedTo(z){if(!z)return v(this.listeners);return L(z.stationMeta,this.listeners,!0)}isAttached(){return this.isAttachedTo(this.originStation)}pause(){let z=this.listeners;for(let B of z)B.isPaused=!0;return this}resume(){let z=this.listeners;for(let B of z)B.isPaused=!1;return this}isPaused(){let z=this.listeners;for(let B of z)if(B.isPaused)return!0;return!1}toPromises(){let z=[],B=this.listeners,J=B.length;for(let G=0;G<J;G++){let K=B[G];z[G]=u(K)}return z}all(){return Promise.all(this.toPromises())}race(){return Promise.race(this.toPromises())}reset(){let z=this.listeners;for(let B of z)B.occurrences=void 0,B.isPaused=void 0;return this}forEach(z){let B=this.listeners,J=B.length;for(let G=0;G<J;G++){let K=B[G];z(K,G,B)}return this}get(z){return this.listeners[z]}index(z){let B=this.listeners,J=B.length;for(let G=0;G<J;G++)if(z===B[G])return G;return}clone(){let z=this.listeners.map(d);return new V(this.originStation,z)}}function u(z){return new Promise((B)=>{if(!z.resolves)z.resolves=[B];else z.resolves.push(B)})}function d(z){if(z.hearer)throw new Error("Cross-emitter listeners can't be cloned.");return{eventName:z.eventName,callback:z.callback,context:z.context,matchCallback:z.matchCallback,matchContext:z.matchContext,isPaused:z.isPaused,occurrences:z.occurrences,maxOccurrences:z.maxOccurrences}}function v(z){for(let B of z)if(p(B))return!0;return!1}function p(z){return z.stationMetas!==void 0}function L(z,B,J){for(let G of B)if(T(z,G,J))return!0;return!1}var h=0;function g(){return String(++h)}var m="all",j={delimiter:" ",emitAllEvent:!0,enableDelimiter:!0,enableRegExp:!1,regExpMarker:"%"},I=_({},j);function M(){_(I,j)}function c(z){let B=_({},I,z);q(B),_(I,z)}function q(z){if(z.delimiter==="")throw new Error("Invalid option: Delimiters can't be empty strings.");if(z.regExpMarker==="")throw new Error("Invalid option: RegExp markers can't be empty strings.");if(z.regExpMarker&&z.delimiter&&z.regExpMarker.indexOf(z.delimiter)>=0)throw new Error("Invalid option: RegExp markers can't contain the delimiter string.")}function _(z){for(let B=1;B<arguments.length;B++){let J=arguments[B];for(let G in J){let K=j.hasOwnProperty(G),Q=J[G];if(K&&Q!=null)z[G]=Q}}return z}class w{stationMeta;constructor(z){w.init(this,z)}get stationId(){return this.stationMeta.stationId}get listenerCount(){return this.stationMeta.listenerCount}get hearingCount(){return this.stationMeta.hearingCount}get listenerEventNames(){return Object.getOwnPropertyNames(this.stationMeta.listenersMap)}on(z,B,J){let G=this.stationMeta,K=$(this,!1,z,B,J);for(let Q of K)f(G,Q);return new V(this,K)}once(z,B,J){return this.on(z,B,J).occur(1)}off(z,B,J){let G=this.stationMeta;if(G.listenerCount<1)return;if(z===void 0){s(G);return}if(B===void 0&&J===void 0&&typeof z==="string"&&(!G.enableDelimiter||z.indexOf(G.delimiter)<0)){t(z,G);return}let K=$(this,!0,z,B,J);for(let Q of K)R(G,Q)}hear(z,B,J,G){let K=this.stationMeta.heardStations,Q=$(this,!1,B,J,G),U=z.stationMeta;for(let W of Q)W.hearer=this,W.crossOrigin=z,f(U,W),K[z.stationId]=z;return new V(z,Q)}hearOnce(z,B,J,G){return this.hear(z,B,J,G).occur(1)}disregard(z,B,J,G){let K=this.stationMeta;if(K.hearingCount<1)return;let Q=!1,U=[];if(B===void 0)Q=!0;else U=$(this,!0,B,J,G);let W=b(K,z),X=W.length;for(let Y=0;Y<X;Y++){let Z=W[Y],D=Z.stationMeta;if(Q)B=Z.listenerEventNames,U=$(this,!0,B,J,G);for(let P of U)P.hearer=this,R(D,P)}if(Q)K.heardStations=Object.create(null);else n(this)}isHeard(z,B,J){let G=this.stationMeta,K=G.listenerCount;if(K<1)return!1;if(arguments.length<1)return K>0;let Q=$(this,!0,z,B,J);for(let U of Q)if(T(G,U))return!0;return!1}isHearing(z,B,J,G){let K=this.stationMeta;if(K.hearingCount<1)return!1;let Q=b(K,z),U=!1,W=[];if(B)W=$(this,!0,B,J,G);else U=!0;let X=Q.length;for(let Y=0;Y<X;Y++){let Z=Q[Y],D=Z.stationMeta;if(U)B=Z.listenerEventNames,W=$(this,!0,B,J,G);for(let P of W)if(P.hearer=this,T(D,P))return!0}return!1}emit(z,...B){let J=this.stationMeta;if(J.listenerCount<1)return[];let G=l(z,J),K=[];for(let Q of G)K=K.concat(a(Q,this,!1,B));return K}async emitAsync(z,...B){let J=this.emit(z,...B);if(J.length===0)return[];return Promise.all(J)}makeListeners(z,B,J){let G=$(this,!1,z,B,J);return new V(this,G)}getListeners(z,B,J){let G=N(this.stationMeta);if(G.length<1)return;if(arguments.length<1)return new V(this,G);let K=$(this,!0,z,B,J),Q=[];for(let U of G)for(let W of K)if(F(W,U)){Q.push(U);break}if(Q.length<1)return;return new V(this,Q)}stopPropagation(){this.stationMeta.isPropagationStopped=!0}addListener(z){f(this.stationMeta,z)}removeListener(z,B){R(this.stationMeta,z,B)}hasListener(z,B){return T(this.stationMeta,z,B)}static init(z,B){return z.stationMeta=o(B),w}static config(z){return c(z),w}static reset(){return M(),w}static create(z){return new w(z)}}function l(z,B){let J;if(typeof z==="string"){let G=B.delimiter;if(B.enableDelimiter&&G)J=z.split(G);else J=[z]}else if(Array.isArray(z))J=z;else throw new Error("Invalid first argument");return J}function o(z={}){let B={heardStations:Object.create(null),hearingCount:0,isPropagationStopped:!1,listenerCount:0,listenersMap:Object.create(null),stationId:g()},J=_(B,I,z);return q(J),J}function $(z,B,J,G,K){if(typeof J==="string"){let Q=z.stationMeta,U=Q.enableDelimiter,W=Q.delimiter;if(U&&J.indexOf(W)>=0){let X=J.split(W);return O(z,B,X,G,K)}return[{eventName:J,callback:G,context:!B&&K===void 0?z:K,matchCallback:G,matchContext:K}]}if(Array.isArray(J))return O(z,B,J,G,K);if(typeof J==="object")return r(z,B,J,G);throw new Error("Invalid arguments")}function r(z,B,J,G){let K=[],Q=Object.getOwnPropertyNames(J);for(let U of Q)K.push({eventName:U,callback:J[U],context:!B&&G===void 0?z:G,matchCallback:J[U],matchContext:G});return K}function O(z,B,J,G,K){let Q=[],U=J.length;for(let W=0;W<U;W++)Q.push({eventName:J[W],callback:G,context:!B&&K===void 0?z:K,matchContext:K,matchCallback:G});return Q}function a(z,B,J,G){let K=B.stationMeta,Q=K.listenersMap,U=void 0;if(K.enableRegExp)U=i(z,Q,K.regExpMarker);else U=Q[z];let W=[];if(U)W=[...W,...A(U,B,J,G)];let X=Q[m];if(K.emitAllEvent&&X){let Y=G.slice();Y.splice(0,0,z),W=[...W,...A(X,B,J,Y)]}return W}function i(z,B,J){let G=[];for(let K in B)if(K.indexOf(J)===0){if(new RegExp(K.substr(J.length)).test(z))G=G.concat(B[K])}else if(K===z)G=G.concat(B[z]);return G}function n(z){let B=Object.create(null),J=z.stationMeta.heardStations;for(let G in J){let K=J[G];if(T(K.stationMeta,{hearer:z}))B[G]=K}z.stationMeta.heardStations=B}function s(z){let B=z.listenersMap;for(let J in B){let G=B[J];for(let K of G){let Q=K.hearer;if(Q)Q.stationMeta.hearingCount--}}z.listenerCount=0,z.listenersMap=Object.create(null)}function t(z,B){let J=B.listenersMap,G=J[z];if(G===void 0)return;let K=G.length;for(let Q=0;Q<K;Q++){let W=G[Q].hearer;if(W)W.stationMeta.hearingCount--}B.listenerCount=B.listenerCount-K,delete J[z]}function b(z,B){if(B===void 0)return e(z);if(Array.isArray(B))return B;if(B.stationMeta)return[B];throw new Error("Invalid target")}function e(z){let B=[],J=z.heardStations;for(let G in J)B.push(J[G]);return B}export{w as EventStation};

//# debugId=F1889A510DDDD70C64756E2164756E21
//# sourceMappingURL=event-station.min.js.map

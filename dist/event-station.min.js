/*
 * event-station v2.0.0-beta.1
 * Copyright (c) 2016-2025 Morris Allison III <author@morris.xyz> (http://morris.xyz). All rights reserved.
 * Released under the MIT license
 * @preserve
 */
function F(z,B){let J=B.eventName,G=z.listenersMap;if(!G[J])G[J]=[];let K=B.stationMetas;if(!K)B.stationMetas=[z];else K.push(z);G[J].push(B),z.listenerCount++;let Q=B.hearer;if(Q)Q.stationMeta.hearingCount++}function I(z,B,J){if(J===!0)return z===B;let G=z.matchCallback;if(G&&G!==B.matchCallback)return!1;let K=z.matchContext;if(K!==void 0&&K!==B.matchContext)return!1;let Q=z.hearer;if(Q&&Q!==B.hearer)return!1;let W=z.eventName;if(W!==void 0&&W!==B.eventName)return!1;return!0}function w(z,B,J){if(z.listenerCount<1)return;let G=z.listenersMap,K=B.eventName,Q=G[K];if(!Q)return;let W=Q.length;if(W===1){if(!I(B,Q[0],J))return;delete G[K],z.listenerCount--,O(B),E(z,B);return}for(let U=0,Y=W;U<Y;U++){let X=Q[U];if(!I(B,X,J))continue;Q.splice(U,1),z.listenerCount--,U--,Y--,O(B),E(z,B)}if(Q.length<1)delete G[K]}function E(z,B){let J=B.stationMetas;if(!J)return;if(J.length===1){B.stationMetas=void 0;return}let G=[];for(let K of J)if(K!==z)G.push(K);if(G.length<1)B.stationMetas=void 0;else B.stationMetas=G}function O(z){let B=z.hearer;if(B)B.stationMeta.hearingCount--}function q(z){let B=z.stationMetas;if(!B)return;for(let J of B)w(J,z,!0)}function A(z,B,J,G){let K=G.length,Q=B.stationMeta;Q.isPropagationStopped=!1;let W=[],U=void 0;z=z.slice();for(let Y of z){if(Q.isPropagationStopped){Q.isPropagationStopped=!1;return}if(Y.isPaused)continue;let{callback:X,context:Z}=Y;if(X)switch(K){case 0:U=X.call(Z);break;case 1:U=X.call(Z,G[0]);break;case 2:U=X.call(Z,G[0],G[1]);break;case 3:U=X.call(Z,G[0],G[1],G[2]);break;default:U=X.apply(Z,G);break}if(J&&U&&typeof U.then==="function"&&typeof U.catch==="function")W.push(U);let V=Y.resolves;if(V){for(let d of V)d(Y);Y.resolves=void 0}let{maxOccurrences:D}=Y,{occurrences:f}=Y;if(D!==void 0){if(f===void 0)f=0;if(Y.occurrences=++f,f===D)q(Y)}}return W}function u(z){if(z.listenerCount<1)return[];let B=z.listenersMap,J=[];for(let G in B)J=J.concat(B[G]);return J}function x(z,B,J){if(B.length<1)return!1;for(let K of B)if(I(z,K,J))return!0;return!1}function R(z,B,J){let G=z.listenersMap,K=B.eventName,Q;if(K===void 0)Q=u(z);else if(Q=G[K],!Q)return!1;return x(B,Q,J)}var _;(function(z){z.$RxObservable=void 0,z.$Promise=Promise})(_||(_={}));var C={NO_PROMISE:"No promises implementation available."};class P{get count(){return this.listeners.length}originStation;listeners;constructor(z,B){this.originStation=z,this.listeners=B}occur(z){if(z<1)throw new Error("The maximum occurrences must be greater than or equal to one.");let B=this.listeners;for(let J of B)J.maxOccurrences=z;return this}calling(z){let B=this.listeners;for(let J of B)J.callback=z,J.matchCallback=z;return this}once(z){return this.calling(z).occur(1)}off(){let z=this.listeners;for(let B of z)q(B);return this}using(z){let B=this.listeners;for(let J of B)J.context=z,J.matchContext=z;return this}addTo(z){let B=this.listeners,J=z.stationMeta;for(let G of B){let K=G.crossOrigin;if(K&&K!==z)throw new Error("Cross-emitter listeners can only be attached to their origin station.");F(J,G)}return this}removeFrom(z){let B=this.listeners,J=z.stationMeta;for(let G of B)w(J,G,!0);return this}moveTo(z){return this.removeFrom(this.originStation),this.originStation=z,this.addTo(z),this}has(z,B){return x(z,this.listeners,B)}attach(){return this.addTo(this.originStation)}detach(){return this.removeFrom(this.originStation)}isAttachedTo(z){if(!z)return g(this.listeners);return m(z.stationMeta,this.listeners,!0)}isAttached(){return this.isAttachedTo(this.originStation)}pause(){let z=this.listeners;for(let B of z)B.isPaused=!0;return this}resume(){let z=this.listeners;for(let B of z)B.isPaused=!1;return this}isPaused(){let z=this.listeners;for(let B of z)if(B.isPaused)return!0;return!1}toPromises(){let z=[],B=this.listeners,J=B.length;for(let G=0;G<J;G++){let K=B[G];z[G]=L(K)}return z}all(){if(!_.$Promise)throw new Error(C.NO_PROMISE);return _.$Promise.all(this.toPromises())}race(){if(!_.$Promise)throw new Error(C.NO_PROMISE);return _.$Promise.race(this.toPromises())}reset(){let z=this.listeners;for(let B of z)B.occurrences=void 0,B.isPaused=void 0;return this}forEach(z){let B=this.listeners,J=B.length;for(let G=0;G<J;G++){let K=B[G];z(K,G,B)}return this}get(z){return this.listeners[z]}index(z){let B=this.listeners,J=B.length;for(let G=0;G<J;G++)if(z===B[G])return G;return}clone(){let z=this.listeners.map(h);return new P(this.originStation,z)}}function L(z){if(!_.$Promise)throw new Error(C.NO_PROMISE);return new _.$Promise((B)=>{if(!z.resolves)z.resolves=[B];else z.resolves.push(B)})}function h(z){if(z.hearer)throw new Error("Cross-emitter listeners can't be cloned.");return{eventName:z.eventName,callback:z.callback,context:z.context,matchCallback:z.matchCallback,matchContext:z.matchContext,isPaused:z.isPaused,occurrences:z.occurrences,maxOccurrences:z.maxOccurrences}}function g(z){for(let B of z)if(p(B))return!0;return!1}function p(z){return z.stationMetas!==void 0}function m(z,B,J){for(let G of B)if(R(z,G,J))return!0;return!1}var M=0;function c(){return String(++M)}var l="all",y={delimiter:" ",emitAllEvent:!0,enableDelimiter:!0,enableRegExp:!1,regExpMarker:"%"},j=H({},y);function o(){H(j,y)}function r(z){let B=H({},j,z);v(B),H(j,z)}function v(z){if(z.delimiter==="")throw new Error("Invalid option: Delimiters can't be empty strings.");if(z.regExpMarker==="")throw new Error("Invalid option: RegExp markers can't be empty strings.");if(z.regExpMarker&&z.delimiter&&z.regExpMarker.indexOf(z.delimiter)>=0)throw new Error("Invalid option: RegExp markers can't contain the delimiter string.")}function H(z){for(let B=1;B<arguments.length;B++){let J=arguments[B];for(let G in J){let K=y.hasOwnProperty(G),Q=J[G];if(K&&Q!=null)z[G]=Q}}return z}class T{stationMeta;constructor(z){T.init(this,z)}get stationId(){return this.stationMeta.stationId}get listenerCount(){return this.stationMeta.listenerCount}get hearingCount(){return this.stationMeta.hearingCount}get listenerEventNames(){return Object.getOwnPropertyNames(this.stationMeta.listenersMap)}on(z,B,J){let G=this.stationMeta,K=$(this,!1,z,B,J);for(let Q of K)F(G,Q);return new P(this,K)}once(z,B,J){return this.on(z,B,J).occur(1)}off(z,B,J){let G=this.stationMeta;if(G.listenerCount<1)return;if(z===void 0){t(G);return}if(B===void 0&&J===void 0&&typeof z==="string"&&(!G.enableDelimiter||z.indexOf(G.delimiter)<0)){e(z,G);return}let K=$(this,!0,z,B,J);for(let Q of K)w(G,Q)}hear(z,B,J,G){let K=this.stationMeta.heardStations,Q=$(this,!1,B,J,G),W=z.stationMeta;for(let U of Q)U.hearer=this,U.crossOrigin=z,F(W,U),K[z.stationId]=z;return new P(z,Q)}hearOnce(z,B,J,G){return this.hear(z,B,J,G).occur(1)}disregard(z,B,J,G){let K=this.stationMeta;if(K.hearingCount<1)return;let Q=!1,W=[];if(B===void 0)Q=!0;else W=$(this,!0,B,J,G);let U=S(K,z),Y=U.length;for(let X=0;X<Y;X++){let Z=U[X],V=Z.stationMeta;if(Q)B=Z.listenerEventNames,W=$(this,!0,B,J,G);for(let D of W)D.hearer=this,w(V,D)}if(Q)K.heardStations=Object.create(null);else s(this)}isHeard(z,B,J){let G=this.stationMeta,K=G.listenerCount;if(K<1)return!1;if(arguments.length<1)return K>0;let Q=$(this,!0,z,B,J);for(let W of Q)if(R(G,W))return!0;return!1}isHearing(z,B,J,G){let K=this.stationMeta;if(K.hearingCount<1)return!1;let Q=S(K,z),W=!1,U=[];if(B)U=$(this,!0,B,J,G);else W=!0;let Y=Q.length;for(let X=0;X<Y;X++){let Z=Q[X],V=Z.stationMeta;if(W)B=Z.listenerEventNames,U=$(this,!0,B,J,G);for(let D of U)if(D.hearer=this,R(V,D))return!0}return!1}emit(z,...B){let J=this.stationMeta;if(J.listenerCount<1)return;let G=k(z,J);for(let K of G)b(K,this,!1,B)}emitAsync(z,...B){if(!_.$Promise)throw new Error("No promises implementation available.");let J=this.stationMeta;if(J.listenerCount<1)return _.$Promise.resolve([]);let G=k(z,J),K=[];for(let Q of G)K=K.concat(b(Q,this,!0,B));if(K.length>0)return _.$Promise.all(K);else return _.$Promise.resolve([])}makeListeners(z,B,J){let G=$(this,!1,z,B,J);return new P(this,G)}getListeners(z,B,J){let G=u(this.stationMeta);if(G.length<1)return;if(arguments.length<1)return new P(this,G);let K=$(this,!0,z,B,J),Q=[];for(let W of G)for(let U of K)if(I(U,W)){Q.push(W);break}if(Q.length<1)return;return new P(this,Q)}stopPropagation(){this.stationMeta.isPropagationStopped=!0}addListener(z){F(this.stationMeta,z)}removeListener(z,B){w(this.stationMeta,z,B)}hasListener(z,B){return R(this.stationMeta,z,B)}static init(z,B){return z.stationMeta=a(B),T}static config(z){return r(z),T}static reset(){return o(),T}static create(z){return new T(z)}}function k(z,B){let J;if(typeof z==="string"){let G=B.delimiter;if(B.enableDelimiter&&G)J=z.split(G);else J=[z]}else if(Array.isArray(z))J=z;else throw new Error("Invalid first argument");return J}function a(z={}){let B={heardStations:Object.create(null),hearingCount:0,isPropagationStopped:!1,listenerCount:0,listenersMap:Object.create(null),stationId:c()},J=H(B,j,z);return v(J),J}function $(z,B,J,G,K){if(typeof J==="string"){let Q=z.stationMeta,W=Q.enableDelimiter,U=Q.delimiter;if(W&&J.indexOf(U)>=0)return J=J.split(U),N(z,B,J,G,K);return[{eventName:J,callback:G,context:!B&&K===void 0?z:K,matchCallback:G,matchContext:K}]}if(Array.isArray(J))return N(z,B,J,G,K);if(typeof J==="object")return i(z,B,J,G);throw new Error("Invalid arguments")}function i(z,B,J,G){let K=[];for(let Q in J)K.push({eventName:Q,callback:J[Q],context:!B&&G===void 0?z:G,matchCallback:J[Q],matchContext:G});return K}function N(z,B,J,G,K){let Q=[],W=J.length;for(let U=0;U<W;U++)Q.push({eventName:J[U],callback:G,context:!B&&K===void 0?z:K,matchContext:K,matchCallback:G});return Q}function b(z,B,J,G){let K=B.stationMeta,Q=K.listenersMap,W=void 0;if(K.enableRegExp)W=n(z,Q,K.regExpMarker);else W=Q[z];let U=[];if(W){let X=A(W,B,J,G);if(J&&X)U=U.concat(X)}let Y=Q[l];if(K.emitAllEvent&&Y){let X=G.slice();X.splice(0,0,z);let Z=A(Y,B,J,X);if(J&&Z)U=U.concat(Z)}return U}function n(z,B,J){let G=[];for(let K in B)if(K.indexOf(J)===0){if(new RegExp(K.substr(J.length)).test(z))G=G.concat(B[K])}else if(K===z)G=G.concat(B[z]);return G}function s(z){let B=Object.create(null),J=z.stationMeta.heardStations;for(let G in J){let K=J[G];if(R(K.stationMeta,{hearer:z}))B[G]=K}z.stationMeta.heardStations=B}function t(z){let B=z.listenersMap;for(let J in B){let G=B[J];for(let K of G){let Q=K.hearer;if(Q)Q.stationMeta.hearingCount--}}z.listenerCount=0,z.listenersMap=Object.create(null)}function e(z,B){let J=B.listenersMap,G=J[z];if(G===void 0)return;let K=G.length;for(let Q=0;Q<K;Q++){let U=G[Q].hearer;if(U)U.stationMeta.hearingCount--}B.listenerCount=B.listenerCount-K,delete J[z]}function S(z,B){if(B===void 0)return zz(z);if(Array.isArray(B))return B;if(B.stationMeta)return[B];throw new Error("Invalid target")}function zz(z){let B=[],J=z.heardStations;for(let G in J)B.push(J[G]);return B}export{T as EventStation};

//# debugId=80F1661E9C14047264756E2164756E21
//# sourceMappingURL=event-station.min.js.map
